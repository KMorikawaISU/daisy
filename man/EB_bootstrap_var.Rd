% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bootstrap.R, R/eb_est.R
\name{EB_bootstrap_var}
\alias{EB_bootstrap_var}
\title{Bootstrap Variance (Appendix B; no auto inside bootstrap)}
\usage{
EB_bootstrap_var(
  dat_int,
  MU_int,
  MU_ext,
  eta,
  n_ext,
  B1 = 200,
  B2 = 200,
  divergence = "KL",
  r = 1,
  w_type = FALSE,
  second_covariate = NULL,
  link = "identity",
  M = 10,
  external.boot = TRUE,
  seed = NULL,
  max_redraws = 50L
)

EB_bootstrap_var(
  dat_int,
  MU_int,
  MU_ext,
  eta,
  n_ext,
  B1 = 200,
  B2 = 200,
  divergence = "KL",
  r = 1,
  w_type = FALSE,
  second_covariate = NULL,
  link = "identity",
  M = 10,
  external.boot = TRUE,
  seed = NULL,
  max_redraws = 50L
)
}
\arguments{
\item{dat_int}{data.frame with internal variables. Must contain column \code{y_int}
(response) and predictors as remaining columns (any names).}

\item{MU_int}{numeric matrix (n x p) of first-step balancing features.
\strong{Do NOT include an intercept column} (the function will add it internally).}

\item{MU_ext}{numeric length-p vector of target moments for the same features
as \code{MU_int}. \strong{Do NOT include an intercept component} (the function will add it internally).}

\item{eta}{numeric scalar: external target used in step-2 (e.g., mean outcome).}

\item{n_ext}{External sample size (n1).}

\item{B1}{Number of bootstrap repetitions used to estimate \code{SigmaW_hat}
(first-level bootstrap over the internal sample).}

\item{B2}{Number of bootstrap repetitions used to generate \code{theta_boot}
(second-level bootstrap for the estimator).}

\item{divergence}{character in {"KL","LW","QLS","TS"}; used when \code{auto = FALSE}.}

\item{r}{numeric; tuning for LW/QLS/TS (ignored for KL) when \code{auto = FALSE}.}

\item{w_type}{logical; if TRUE, the internal regression is weighted by first-step w.}

\item{second_covariate}{optional matrix for additional second-step constraints (unused here).}

\item{link}{"identity" | "logit" | "probit" | "gamma".}

\item{M}{numeric; box bound for step-2 lambda.}

\item{external.boot}{TRUE resamples external summaries; FALSE fixes them.}

\item{seed}{Optional RNG seed.}

\item{max_redraws}{Maximum number of resampling attempts per bootstrap
iteration when the estimator fails to produce a finite estimate.
If this limit is exceeded, the corresponding bootstrap replicate is stored
as NA.}

\item{BB}{Bootstrap repetitions (B1=B2=BB).}
}
\value{
List: point_estimate, bootstrap_se/var, 95\% CIs, SigmaW_hat, theta_boot.

List with elements:
\itemize{
\item \code{point_estimate} Point estimate from the original data.
\item \code{bootstrap_se}, \code{bootstrap_var} Bootstrap standard error/variance.
\item \code{ci_normal_95}, \code{ci_percentile_95} 95\\% confidence intervals.
\item \code{SigmaW_hat} Estimated covariance of (mu_x, eta).
\item \code{theta_boot} Vector of bootstrap estimates.
\item \code{bootstrap_redraws_total} Total number of redraws due to non-convergence.
\item \code{bootstrap_redraws_per_iteration} Integer vector of redraw counts per bootstrap iteration.
}
}
\description{
Bootstrap Variance (Appendix B; no auto inside bootstrap)

Bootstrap Variance (Appendix B; no auto inside bootstrap)
}
